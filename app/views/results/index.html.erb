<%= content_for :page_title, "#{number_with_delimiter(@results_view.course_count)} courses" %>

<div class="govuk-width-container">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <% if @results_view.provider_filter? %>
        <h1 class="govuk-heading-xl" data-qa="provider_title">
          <span class="govuk-caption-l">Teacher training courses</span>
          <%= @results_view.provider %>
        </h1>
      <% else %>
        <h1 class="govuk-heading-xl" data-qa="heading">Teacher training courses</h1>
      <% end %>
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-one-third">
      <div class="govuk-toggle" data-module="toggle">
        <button class="govuk-toggle__link js-toggle" aria-expanded="false" aria-controls="searchFilters">
        </button>
        <div class="govuk-toggle__target" id="searchFilters" data-qa="filters">
          <% if @results_view.provider_filter? %>
            <%= render partial: 'results/provider' %>
          <% else %>
            <%= render partial: 'results/location' %>
          <% end %>
          <%= render partial: 'results/subjects' %>
          <%= render partial: 'results/study_type' %>
          <%= render partial: 'results/qualifications' %>
          <%= render partial: 'results/funding' %>
          <%= render partial: 'results/vacancy' %>
        </div>
      </div>
    </div>
    <div class="govuk-grid-column-two-thirds">
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body search-results__count" data-qa="course-count"><%= number_with_delimiter(@results_view.course_count) %> courses found</p>
        </div>
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body search-results__new-search">
            <%= link_to "New search", root_path, class: "govuk-link" %>
          </p>
        </div>
      </div>
      <ul class="govuk-list search-results">
        <% @results_view.courses.each do |course| %>
          <li data-qa="course">
            <h3 class="govuk-heading-m govuk-!-margin-bottom-6">
              <%= link_to course_path(provider_code: course.provider_code, course_code: course.course_code), class: "govuk-link  search-result-link", rel: "prev", data: { qa: "course__link" } do %>
                <span data-qa="course__provider_name" class="govuk-!-font-size-19"><%= course.provider.provider_name %></span>
                <br>
                <span data-qa="course__name" class="search-result-link-name govuk-!-font-size-24"><%= course.decorate.display_title %></span>
              <% end %>
            </h3>
            <dl class="govuk-list--description">
              <dt class="govuk-list--description__label">Course</dt>
              <dd data-qa="course__description"><%= course.description%></dd>
              <dt class="govuk-list--description__label">Financial support</dt>
              <dd data-qa="course__funding_options"><%= course.decorate.funding_option %></dd>
              <% if course.accrediting_provider.present? %>
                <dt>Accredited body</dt>
                <dd data-qa="course__accrediting_provider"><%= course.accrediting_provider.provider_name %></dd>
                <% end %>
                  <dt class="govuk-list--description__label">Main address</dt>
                  <dd data-qa="course__main_address">
                <%= course.provider.decorate.short_address %>
              </dd>
            </dl>
          </li>
        <% end %>
      </ul>
      <%= paginate @results_view.courses %>
    </div>
  </div>
</div>
